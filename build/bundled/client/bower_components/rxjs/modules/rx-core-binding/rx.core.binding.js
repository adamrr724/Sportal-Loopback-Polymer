(function(t){function s(t){return t&&t.Object===Object?t:null}var e={"function":!0,object:!0},i=e[typeof exports]&&exports&&!exports.nodeType?exports:null,r=e[typeof module]&&module&&!module.nodeType?module:null,o=s(i&&r&&"object"==typeof global&&global),n=s(e[typeof self]&&self),h=s(e[typeof window]&&window),u=(r&&r.exports===i?i:null,s(e[typeof this]&&this)),c=o||h!==(u&&u.window)&&h||n||u||Function("return this")();"function"==typeof define&&define.amd?define(["./rx.core"],function(s,e){return t(c,e,s)}):"object"==typeof module&&module&&module.exports===i?module.exports=t(c,module.exports,require("./rx.core")):c.Rx=t(c,{},c.Rx)}).call(this,function(t,s,e,i){function r(t){for(var s=t.length,e=new Array(s),i=0;s>i;i++)e[i]=t[i];return e}function o(t){return function(){try{return t.apply(this,arguments)}catch(s){return w.e=s,w}}}function n(t){throw t}var h=e.Observable,u=h.prototype,c=(e.AnonymousObservable,e.ObservableBase),p=e.Observer,l=e.internals.AbstractObserver,f=e.Disposable.create,a=e.Disposable.empty,b=(e.CompositeDisposable,e.BinaryDisposable),d=e.SerialDisposable,v=e.Scheduler.currentThread,_=e.helpers.isFunction,y=e.internals.inherits,m=e.internals.addProperties,S=e.Disposable.checkDisposed,w={e:{}},g=e.internals.tryCatch=function(t){if(!_(t))throw new TypeError("fn must be a function");return o(t)},x=function(t){function s(s,e,i){this.source=s,this._fn1=e,this._fn2=i,t.call(this)}return y(s,t),s.prototype.subscribeCore=function(t){var s=this.source.multicast(this._fn1());return new b(this._fn2(s).subscribe(t),s.connect())},s}(c);u.multicast=function(t,s){return _(t)?new x(this,t,s):new V(this,t)},u.publish=function(t){return t&&_(t)?this.multicast(function(){return new q},t):this.multicast(new q)},u.share=function(){return this.publish().refCount()},u.publishLast=function(t){return t&&_(t)?this.multicast(function(){return new O},t):this.multicast(new O)},u.publishValue=function(t,s){return 2===arguments.length?this.multicast(function(){return new j(s)},t):this.multicast(new j(t))},u.shareValue=function(t){return this.publishValue(t).refCount()},u.replay=function(t,s,e,i){return t&&_(t)?this.multicast(function(){return new A(s,e,i)},t):this.multicast(new A(s,e,i))},u.shareReplay=function(t,s,e){return this.replay(null,t,s,e).refCount()};var E=e.internals.ScheduledObserver=function(t){function s(s,e){t.call(this),this.scheduler=s,this.observer=e,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new d}function e(t,s){return function(){t.onNext(s)}}function i(t,s){return function(){t.onError(s)}}function r(t){return function(){t.onCompleted()}}function o(t,s){var e;if(!(t.queue.length>0))return void(t.isAcquired=!1);e=t.queue.shift();var i=g(e)();return i===w?(t.queue=[],t.hasFaulted=!0,n(i.e)):void s(t)}return y(s,t),s.prototype.next=function(t){this.queue.push(e(this.observer,t))},s.prototype.error=function(t){this.queue.push(i(this.observer,t))},s.prototype.completed=function(){this.queue.push(r(this.observer))},s.prototype.ensureActive=function(){var t=!1;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,o))},s.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},s}(l),C=function(t,s){this._s=t,this._o=s};C.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var q=e.Subject=function(t){function s(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return y(s,t),m(s.prototype,p.prototype,{_subscribe:function(t){return S(this),this.isStopped?this.hasError?(t.onError(this.error),a):(t.onCompleted(),a):(this.observers.push(t),new C(this,t))},hasObservers:function(){return S(this),this.observers.length>0},onCompleted:function(){if(S(this),!this.isStopped){this.isStopped=!0;for(var t=0,s=r(this.observers),e=s.length;e>t;t++)s[t].onCompleted();this.observers.length=0}},onError:function(t){if(S(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var s=0,e=r(this.observers),i=e.length;i>s;s++)e[s].onError(t);this.observers.length=0}},onNext:function(t){if(S(this),!this.isStopped)for(var s=0,e=r(this.observers),i=e.length;i>s;s++)e[s].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),s.create=function(t,s){return new D(t,s)},s}(h),D=e.AnonymousSubject=function(t){function s(s,e){this.observer=s,this.observable=e,t.call(this)}return y(s,t),m(s.prototype,p.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),s}(h),O=e.AsyncSubject=function(t){function s(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return y(s,t),m(s.prototype,p.prototype,{_subscribe:function(t){return S(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),a):(this.observers.push(t),new C(this,t))},hasObservers:function(){return S(this),this.observers.length>0},onCompleted:function(){var t,s;if(S(this),!this.isStopped){this.isStopped=!0;var e=r(this.observers),s=e.length;if(this.hasValue)for(t=0;s>t;t++){var i=e[t];i.onNext(this.value),i.onCompleted()}else for(t=0;s>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(S(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var s=0,e=r(this.observers),i=e.length;i>s;s++)e[s].onError(t);this.observers.length=0}},onNext:function(t){S(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),s}(h),j=e.BehaviorSubject=function(t){function s(s){t.call(this),this.value=s,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return y(s,t),m(s.prototype,p.prototype,{_subscribe:function(t){return S(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),a):(this.observers.push(t),t.onNext(this.value),new C(this,t))},getValue:function(){return S(this),this.hasError&&n(this.error),this.value},hasObservers:function(){return S(this),this.observers.length>0},onCompleted:function(){if(S(this),!this.isStopped){this.isStopped=!0;for(var t=0,s=r(this.observers),e=s.length;e>t;t++)s[t].onCompleted();this.observers.length=0}},onError:function(t){if(S(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var s=0,e=r(this.observers),i=e.length;i>s;s++)e[s].onError(t);this.observers.length=0}},onNext:function(t){if(S(this),!this.isStopped){this.value=t;for(var s=0,e=r(this.observers),i=e.length;i>s;s++)e[s].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),s}(h),A=e.ReplaySubject=function(t){function s(t,s){return f(function(){s.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(s),1)})}function e(s,e,r){this.bufferSize=null==s?i:s,this.windowSize=null==e?i:e,this.scheduler=r||v,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this)}var i=Math.pow(2,53)-1;return y(e,t),m(e.prototype,p.prototype,{_subscribe:function(t){S(this);var e=new E(this.scheduler,t),i=s(this,e);this._trim(this.scheduler.now()),this.observers.push(e);for(var r=0,o=this.q.length;o>r;r++)e.onNext(this.q[r].value);return this.hasError?e.onError(this.error):this.isStopped&&e.onCompleted(),e.ensureActive(),i},hasObservers:function(){return S(this),this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(S(this),!this.isStopped){var s=this.scheduler.now();this.q.push({interval:s,value:t}),this._trim(s);for(var e=0,i=r(this.observers),o=i.length;o>e;e++){var n=i[e];n.onNext(t),n.ensureActive()}}},onError:function(t){if(S(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var s=this.scheduler.now();this._trim(s);for(var e=0,i=r(this.observers),o=i.length;o>e;e++){var n=i[e];n.onError(t),n.ensureActive()}this.observers.length=0}},onCompleted:function(){if(S(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var s=0,e=r(this.observers),i=e.length;i>s;s++){var o=e[s];o.onCompleted(),o.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),e}(h),N=function(t){function s(s){this.source=s,this._count=0,this._connectableSubscription=null,t.call(this)}function e(t,s){this._p=t,this._s=s,this.isDisposed=!1}return y(s,t),s.prototype.subscribeCore=function(t){var s=this.source.subscribe(t);return 1===++this._count&&(this._connectableSubscription=this.source.connect()),new e(this,s)},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0===--this._p._count&&this._p._connectableSubscription.dispose())},s}(c),V=e.ConnectableObservable=function(t){function s(s,e){this.source=s,this._connection=null,this._source=s.asObservable(),this._subject=e,t.call(this)}function e(t,s){this._p=t,this._s=s}return y(s,t),e.prototype.dispose=function(){this._s&&(this._s.dispose(),this._s=null,this._p._connection=null)},s.prototype.connect=function(){if(!this._connection){if(this._subject.isStopped)return a;var t=this._source.subscribe(this._subject);this._connection=new e(this,t)}return this._connection},s.prototype._subscribe=function(t){return this._subject.subscribe(t)},s.prototype.refCount=function(){return new N(this)},s}(h);return e});