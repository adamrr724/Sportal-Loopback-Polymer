(function(t){function e(t){return t&&t.Object===Object?t:null}var n={"function":!0,object:!0},r=n[typeof exports]&&exports&&!exports.nodeType?exports:null,o=n[typeof module]&&module&&!module.nodeType?module:null,i=e(r&&o&&"object"==typeof global&&global),s=e(n[typeof self]&&self),u=e(n[typeof window]&&window),c=(o&&o.exports===r?r:null,e(n[typeof this]&&this)),h=i||u!==(c&&c.window)&&u||s||c||Function("return this")();"function"==typeof define&&define.amd?define(["./rx"],function(e,n){return t(h,n,e)}):"object"==typeof module&&module&&module.exports===r?module.exports=t(h,module.exports,require("./rx")):h.Rx=t(h,{},h.Rx)}).call(this,function(t,e,n,r){function o(t){return function(){try{return t.apply(this,arguments)}catch(e){return I.e=e,I}}}function i(t,e){return new z(t,e)}function s(t,e,n){return new m(function(r){var o=t,i=O(e);return n.scheduleRecursiveFuture(0,o,function(t,e){if(i>0){var s=n.now();o=new Date(o.getTime()+i),o.getTime()<=s&&(o=new Date(s+i))}r.onNext(t),e(t+1,new Date(o))})})}function u(t,e,n){return t===e?new m(function(t){return n.schedulePeriodic(0,e,function(e){return t.onNext(e),e+1})}):x(function(){return s(new Date(n.now()+t),e,n)})}function c(t,e,n){return new m(function(r){var o,i=!1,s=new N,u=null,c=[],h=!1;return o=t.materialize().timestamp(n).subscribe(function(t){var o,l;"E"===t.value.kind?(c=[],c.push(t),u=t.value.error,l=!h):(c.push({value:t.value,timestamp:t.timestamp+e}),l=!i,i=!0),l&&(null!==u?r.onError(u):(o=new F,s.setDisposable(o),o.setDisposable(n.scheduleRecursiveFuture(null,e,function(t,e){var o,s,l,f;if(null===u){h=!0;do l=null,c.length>0&&c[0].timestamp-n.now()<=0&&(l=c.shift().value),null!==l&&l.accept(r);while(null!==l);f=!1,s=0,c.length>0?(f=!0,s=Math.max(0,c[0].timestamp-n.now())):i=!1,o=u,h=!1,null!==o?r.onError(o):f&&e(null,s)}}))))}),new S(o,s)},t)}function h(t,e,n){return x(function(){return c(t,e-n.now(),n)})}function l(t,e,n){var r,o;return j(e)?o=e:(r=e,o=n),new m(function(e){function n(){c.setDisposable(t.subscribe(function(t){var n=V(o)(t);if(n===I)return e.onError(n.e);var r=new F;s.add(r),r.setDisposable(n.subscribe(function(){e.onNext(t),s.remove(r),i()},function(t){e.onError(t)},function(){e.onNext(t),s.remove(r),i()}))},function(t){e.onError(t)},function(){u=!0,c.dispose(),i()}))}function i(){u&&0===s.length&&e.onCompleted()}var s=new g,u=!1,c=new N;return r?c.setDisposable(r.subscribe(n,function(t){e.onError(t)},n)):n(),new S(c,s)},t)}function f(t,e){return new m(function(n){var r,o=!1,i=new N,s=0,u=t.subscribe(function(t){var u=V(e)(t);if(u===I)return n.onError(u.e);k(u)&&(u=M(u)),o=!0,r=t,s++;var c=s,h=new F;i.setDisposable(h),h.setDisposable(u.subscribe(function(){o&&s===c&&n.onNext(r),o=!1,h.dispose()},function(t){n.onError(t)},function(){o&&s===c&&n.onNext(r),o=!1,h.dispose()}))},function(t){i.dispose(),n.onError(t),o=!1,s++},function(){i.dispose(),o&&n.onNext(r),n.onCompleted(),o=!1,s++});return new S(u,i)},t)}function a(t){return t.toArray()}function a(t){return t.toArray()}function p(t,e,n,r){return j(e)&&(r=n,n=e,e=E()),d.isObservable(r)||(r=C(new Y)),new m(function(o){function i(t){function e(){return f=n===l}var n=l,i=new F;c.setDisposable(i),i.setDisposable(t.subscribe(function(){e()&&u.setDisposable(r.subscribe(o)),i.dispose()},function(t){e()&&o.onError(t)},function(){e()&&u.setDisposable(r.subscribe(o))}))}function s(){var t=!f;return t&&l++,t}var u=new N,c=new N,h=new F;u.setDisposable(h);var l=0,f=!1;return i(e),h.setDisposable(t.subscribe(function(t){if(s()){o.onNext(t);var e=V(n)(t);if(e===I)return o.onError(e.e);i(k(e)?M(e):e)}},function(t){s()&&o.onError(t)},function(){s()&&o.onCompleted()})),new S(u,c)},t)}function _(t,e,n,r){return A(n)&&(r=n,n=C(new Y)),n instanceof Error&&(n=C(n)),A(r)||(r=D),d.isObservable(n)||(n=C(new Y)),new m(function(o){function i(){var t=s;l.setDisposable(r.scheduleFuture(null,e,function(){h=s===t,h&&(k(n)&&(n=M(n)),c.setDisposable(n.subscribe(o)))}))}var s=0,u=new F,c=new N,h=!1,l=new N;return c.setDisposable(u),i(),u.setDisposable(t.subscribe(function(t){h||(s++,o.onNext(t),i())},function(t){h||(s++,o.onError(t))},function(){h||(s++,o.onCompleted())})),new S(c,l)},t)}var b=n.internals.inherits,w=n.internals.AbstractObserver,d=n.Observable,v=d.prototype,m=n.AnonymousObservable,y=n.ObservableBase,x=d.defer,E=(d.empty,d.never),C=d["throw"],D=(d.fromArray,n.Scheduler["default"]),F=n.SingleAssignmentDisposable,N=n.SerialDisposable,g=n.CompositeDisposable,S=n.BinaryDisposable,T=n.RefCountDisposable,R=n.Subject,q=n.internals.addRef,O=n.Scheduler.normalize,W=n.helpers,k=W.isPromise,j=W.isFunction,A=n.Scheduler.isScheduler,M=d.fromPromise,I={e:{}},V=n.internals.tryCatch=function(t){if(!j(t))throw new TypeError("fn must be a function");return o(t)},z=function(t){function e(e,n){this._dt=e,this._s=n,t.call(this)}function n(t,e){e.onNext(0),e.onCompleted()}return b(e,t),e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,n)},e}(y),B=d.interval=function(t,e){return u(t,t,A(e)?e:D)};d.timer=function(t,e,n){var o;return A(n)||(n=D),null!=e&&"number"==typeof e?o=e:A(e)&&(n=e),(t instanceof Date||"number"==typeof t)&&o===r?i(t,n):t instanceof Date&&o!==r?s(t,e,n):u(t,o,n)},v.delay=function(){var t=arguments[0];if("number"==typeof t||t instanceof Date){var e=t,n=arguments[1];return A(n)||(n=D),e instanceof Date?h(this,e,n):c(this,e,n)}if(d.isObservable(t)||j(t))return l(this,t,arguments[1]);throw new Error("Invalid arguments")};var L=function(t){function e(e,n,r){A(r)||(r=D),this.source=e,this._dt=n,this._s=r,t.call(this)}return b(e,t),e.prototype.subscribeCore=function(t){var e=new N;return new S(this.source.subscribe(new P(t,this._dt,this._s,e)),e)},e}(y),P=function(t){function e(e,n,r,o){this._o=e,this._d=n,this._scheduler=r,this._c=o,this._v=null,this._hv=!1,this._id=0,t.call(this)}return b(e,t),e.prototype.next=function(t){this._hv=!0,this._v=t;var e=++this._id,n=new F;this._c.setDisposable(n),n.setDisposable(this._scheduler.scheduleFuture(this,this._d,function(n,r){r._hv&&r._id===e&&r._o.onNext(t),r._hv=!1}))},e.prototype.error=function(t){this._c.dispose(),this._o.onError(t),this._hv=!1,this._id++},e.prototype.completed=function(){this._c.dispose(),this._hv&&this._o.onNext(this._v),this._o.onCompleted(),this._hv=!1,this._id++},e}(w);v.debounce=function(){if(j(arguments[0]))return f(this,arguments[0]);if("number"==typeof arguments[0])return new L(this,arguments[0],arguments[1]);throw new Error("Invalid arguments")},v.windowWithTime=v.windowTime=function(t,e,n){var r,o=this;return null==e&&(r=t),A(n)||(n=D),"number"==typeof e?r=e:A(e)&&(r=t,n=e),new m(function(e){function i(){var t=new F,o=!1,s=!1;f.setDisposable(t),h===c?(o=!0,s=!0):c>h?o=!0:s=!0;var p=o?h:c,_=p-a;a=p,o&&(h+=r),s&&(c+=r),t.setDisposable(n.scheduleFuture(null,_,function(){if(s){var t=new R;l.push(t),e.onNext(q(t,u))}o&&l.shift().onCompleted(),i()}))}var s,u,c=r,h=t,l=[],f=new N,a=0;return s=new g(f),u=new T(s),l.push(new R),e.onNext(q(l[0],u)),i(),s.add(o.subscribe(function(t){for(var e=0,n=l.length;n>e;e++)l[e].onNext(t)},function(t){for(var n=0,r=l.length;r>n;n++)l[n].onError(t);e.onError(t)},function(){for(var t=0,n=l.length;n>t;t++)l[t].onCompleted();e.onCompleted()})),u},o)},v.windowWithTimeOrCount=v.windowTimeOrCount=function(t,e,n){var r=this;return A(n)||(n=D),new m(function(o){function i(e){var r=new F;s.setDisposable(r),r.setDisposable(n.scheduleFuture(null,t,function(){if(e===l){h=0;var t=++l;f.onCompleted(),f=new R,o.onNext(q(f,c)),i(t)}}))}var s=new N,u=new g(s),c=new T(u),h=0,l=0,f=new R;return o.onNext(q(f,c)),i(0),u.add(r.subscribe(function(t){var n=0,r=!1;f.onNext(t),++h===e&&(r=!0,h=0,n=++l,f.onCompleted(),f=new R,o.onNext(q(f,c))),r&&i(n)},function(t){f.onError(t),o.onError(t)},function(){f.onCompleted(),o.onCompleted()})),c},r)},v.bufferWithTime=v.bufferTime=function(t,e,n){return this.windowWithTime(t,e,n).flatMap(a)},v.bufferWithTimeOrCount=v.bufferTimeOrCount=function(t,e,n){return this.windowWithTimeOrCount(t,e,n).flatMap(a)};var U=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return b(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new G(t,this._s))},e}(y),G=function(t){function e(e,n){this._o=e,this._s=n,this._l=n.now(),t.call(this)}return b(e,t),e.prototype.next=function(t){var e=this._s.now(),n=e-this._l;this._l=e,this._o.onNext({value:t,interval:n})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(w);v.timeInterval=function(t){return A(t)||(t=D),new U(this,t)};var H=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return b(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new J(t,this._s))},e}(y),J=function(t){function e(e,n){this._o=e,this._s=n,t.call(this)}return b(e,t),e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(w);v.timestamp=function(t){return A(t)||(t=D),new H(this,t)};var K=function(t){function e(e,n){this.source=e,this._sampler=n,t.call(this)}return b(e,t),e.prototype.subscribeCore=function(t){var e={o:t,atEnd:!1,value:null,hasValue:!1,sourceSubscription:new F};return e.sourceSubscription.setDisposable(this.source.subscribe(new X(e))),new S(e.sourceSubscription,this._sampler.subscribe(new Q(e)))},e}(y),Q=function(t){function e(e){this._s=e,t.call(this)}return b(e,t),e.prototype._handleMessage=function(){this._s.hasValue&&(this._s.hasValue=!1,this._s.o.onNext(this._s.value)),this._s.atEnd&&this._s.o.onCompleted()},e.prototype.next=function(){this._handleMessage()},e.prototype.error=function(t){this._s.onError(t)},e.prototype.completed=function(){this._handleMessage()},e}(w),X=function(t){function e(e){this._s=e,t.call(this)}return b(e,t),e.prototype.next=function(t){this._s.hasValue=!0,this._s.value=t},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.atEnd=!0,this._s.sourceSubscription.dispose()},e}(w);v.sample=function(t,e){return A(e)||(e=D),"number"==typeof t?new K(this,B(t,e)):new K(this,t)};var Y=n.TimeoutError=function(t){this.message=t||"Timeout has occurred",this.name="TimeoutError",Error.call(this)};Y.prototype=Object.create(Error.prototype),v.timeout=function(){var t=arguments[0];if(t instanceof Date||"number"==typeof t)return _(this,t,arguments[1],arguments[2]);if(d.isObservable(t)||j(t))return p(this,t,arguments[1],arguments[2]);throw new Error("Invalid arguments")};var Z=function(t){function e(e,n,r,o,i,s){this._state=e,this._cndFn=n,this._itrFn=r,this._resFn=o,this._timeFn=i,this._s=s,t.call(this)}function n(t,e){if(t.hasResult&&t.o.onNext(t.result),t.first)t.first=!1;else if(t.newState=V(t.self._itrFn)(t.newState),t.newState===I)return t.o.onError(t.newState.e);if(t.hasResult=V(t.self._cndFn)(t.newState),t.hasResult===I)return t.o.onError(t.hasResult.e);if(t.hasResult){if(t.result=V(t.self._resFn)(t.newState),t.result===I)return t.o.onError(t.result.e);var n=V(t.self._timeFn)(t.newState);if(n===I)return t.o.onError(n.e);e(t,n)}else t.o.onCompleted()}return b(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(e,new Date(this._s.now()),n)},e}(y);d.generateWithAbsoluteTime=function(t,e,n,r,o,i){return A(i)||(i=D),new Z(t,e,n,r,o,i)};var $=function(t){function e(e,n,r,o,i,s){this._state=e,this._cndFn=n,this._itrFn=r,this._resFn=o,this._timeFn=i,this._s=s,t.call(this)}function n(t,e){if(t.hasResult&&t.o.onNext(t.result),t.first)t.first=!1;else if(t.newState=V(t.self._itrFn)(t.newState),t.newState===I)return t.o.onError(t.newState.e);if(t.hasResult=V(t.self._cndFn)(t.newState),t.hasResult===I)return t.o.onError(t.hasResult.e);if(t.hasResult){if(t.result=V(t.self._resFn)(t.newState),t.result===I)return t.o.onError(t.result.e);var n=V(t.self._timeFn)(t.newState);if(n===I)return t.o.onError(n.e);e(t,n)}else t.o.onCompleted()}return b(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(e,0,n)},e}(y);d.generateWithRelativeTime=function(t,e,n,r,o,i){return A(i)||(i=D),new $(t,e,n,r,o,i)};var tt=function(t){function e(e,n,r){this.source=e,this._dt=n,this._s=r,t.call(this)}function n(t,e){var n=e[0],r=e[1],o=e[2];o.setDisposable(n.subscribe(r))}return b(e,t),e.prototype.subscribeCore=function(t){var e=new N;return e.setDisposable(this._s.scheduleFuture([this.source,t,e],this._dt,n)),e},e}(y);v.delaySubscription=function(t,e){return A(e)||(e=D),new tt(this,t,e)};var et=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,t.call(this)}return b(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new nt(t,this))},e}(y),nt=function(t){function e(e,n){this._o=e,this._s=n._s,this._d=n._d,this._q=[],t.call(this)}return b(e,t),e.prototype.next=function(t){var e=this._s.now();for(this._q.push({interval:e,value:t});this._q.length>0&&e-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(var t=this._s.now();this._q.length>0&&t-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value);this._o.onCompleted()},e}(w);v.skipLastWithTime=function(t,e){return A(e)||(e=D),new et(this,t,e)};var rt=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,t.call(this)}return b(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new ot(t,this._d,this._s))},e}(y),ot=function(t){function e(e,n,r){this._o=e,this._d=n,this._s=r,this._q=[],t.call(this)}return b(e,t),e.prototype.next=function(t){var e=this._s.now();for(this._q.push({interval:e,value:t});this._q.length>0&&e-this._q[0].interval>=this._d;)this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(var t=this._s.now();this._q.length>0;){var e=this._q.shift();t-e.interval<=this._d&&this._o.onNext(e.value)}this._o.onCompleted()},e}(w);v.takeLastWithTime=function(t,e){return A(e)||(e=D),new rt(this,t,e)},v.takeLastBufferWithTime=function(t,e){var n=this;return A(e)||(e=D),new m(function(r){var o=[];return n.subscribe(function(n){var r=e.now();for(o.push({interval:r,value:n});o.length>0&&r-o[0].interval>=t;)o.shift()},function(t){r.onError(t)},function(){for(var n=e.now(),i=[];o.length>0;){var s=o.shift();n-s.interval<=t&&i.push(s.value)}r.onNext(i),r.onCompleted()})},n)};var it=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,t.call(this)}function n(t,e){e.onCompleted()}return b(e,t),e.prototype.subscribeCore=function(t){return new S(this._s.scheduleFuture(t,this._d,n),this.source.subscribe(t))},e}(y);v.takeWithTime=function(t,e){return A(e)||(e=D),new it(this,t,e)};var st=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,this._open=!1,t.call(this)}function n(t,e){e._open=!0}return b(e,t),e.prototype.subscribeCore=function(t){return new S(this._s.scheduleFuture(this,this._d,n),this.source.subscribe(new ut(t,this)))},e}(y),ut=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return b(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(w);v.skipWithTime=function(t,e){return A(e)||(e=D),new st(this,t,e)};var ct=function(t){function e(e,n,r){this.source=e,this._st=n,this._s=r,t.call(this)}function n(t,e){e._open=!0}return b(e,t),e.prototype.subscribeCore=function(t){return this._open=!1,new S(this._s.scheduleFuture(this,this._st,n),this.source.subscribe(new ht(t,this)))},e}(y),ht=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return b(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(w);return v.skipUntilWithTime=function(t,e){return A(e)||(e=D),new ct(this,t,e)},v.takeUntilWithTime=function(t,e){A(e)||(e=D);var n=this;return new m(function(r){return new S(e.scheduleFuture(r,t,function(t,e){e.onCompleted()}),n.subscribe(r))},n)},v.throttle=function(t,e){A(e)||(e=D);var n=+t||0;if(0>=n)throw new RangeError("windowDuration cannot be less or equal zero.");var r=this;return new m(function(t){var o=0;return r.subscribe(function(r){var i=e.now();(0===o||i-o>=n)&&(o=i,t.onNext(r))},function(e){t.onError(e)},function(){t.onCompleted()})},r)},n});