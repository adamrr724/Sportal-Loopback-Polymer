(function(e){function t(e){return e&&e.Object===Object?e:null}var r={"function":!0,object:!0},n=r[typeof exports]&&exports&&!exports.nodeType?exports:null,s=r[typeof module]&&module&&!module.nodeType?module:null,o=t(n&&s&&"object"==typeof global&&global),i=t(r[typeof self]&&self),c=t(r[typeof window]&&window),u=(s&&s.exports===n?n:null,t(r[typeof this]&&this)),l=o||c!==(u&&u.window)&&c||i||u||Function("return this")();"function"==typeof define&&define.amd?define(["./rx.core"],function(t,r){return e(l,r,t)}):"object"==typeof module&&module&&module.exports===n?module.exports=e(l,module.exports,require("./rx.core")):l.Rx=e(l,{},l.Rx)}).call(this,function(e,t,r,n){function s(e,t,r,s,o,i){var c=le(e),u=c.length,l=le(t),a=l.length;if(u!==a&&!s)return!1;for(var h,p=u;p--;)if(h=c[p],!(s?h in t:ie.call(t,h)))return!1;for(var f=s;++p<u;){h=c[p];var d,b=e[h],v=t[h];if(!(d===n?r(b,v,s,o,i):d))return!1;f||(f="constructor"===h)}if(!f){var m=e.constructor,y=t.constructor;if(m!==y&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y))return!1}return!0}function o(e,t,r){switch(r){case F:case M:return+e===+t;case U:return e.name===t.name&&e.message===t.message;case V:return e!==+e?t!==+t:e===+t;case H:case W:return e===t+""}return!1}function i(e){return!!e&&"object"==typeof e}function c(e){return"number"==typeof e&&e>-1&&e%1===0&&ue>=e}function u(e){return i(e)&&c(e.length)&&!!se[ce.call(e)]}function l(e,t){for(var r=-1,n=e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function a(e,t,r,s,o,i){var c=-1,u=e.length,a=t.length;if(u!==a&&!(s&&a>u))return!1;for(;++c<u;){var h,p=e[c],f=t[c];if(h!==n){if(h)continue;return!1}if(s){if(!l(t,function(e){return p===e||r(p,e,s,o,i)}))return!1}else if(p!==f&&!r(p,f,s,o,i))return!1}return!0}function h(e,t,r,n,i,c){var l=pe(e),h=pe(t),p=D,f=D;l||(p=ce.call(e),p===I?p=X:p!==X&&(l=u(e))),h||(f=ce.call(t),f===I&&(f=X));var d=p===X&&!he(e),b=f===X&&!he(t),v=p===f;if(v&&!l&&!d)return o(e,t,p);if(!n){var m=d&&ie.call(e,"__wrapped__"),y=b&&ie.call(t,"__wrapped__");if(m||y)return r(m?e.value():e,y?t.value():t,n,i,c)}if(!v)return!1;i||(i=[]),c||(c=[]);for(var g=i.length;g--;)if(i[g]===e)return c[g]===t;i.push(e),c.push(t);var w=(l?a:s)(e,t,r,n,i,c);return i.pop(),c.pop(),w}function p(e,t,r,n,s){return e===t?!0:null==e||null==t||!ae(e)&&!i(t)?e!==e&&t!==t:h(e,t,p,r,n,s)}function f(e){this.predicate=e}function d(e){this.predicate=e}function b(e,t){var r=this;this.scheduler=e,this.messages=t,this.subscriptions=[],this.observers=[];for(var n=0,s=this.messages.length;s>n;n++){var o=this.messages[n],i=o.value;!function(t){e.scheduleAbsolute(null,o.time,function(){for(var e=r.observers.slice(0),n=0,s=e.length;s>n;n++)t.accept(e[n]);return g})}(i)}}var v=r.Observer,m=r.Observable,y=r.Disposable,g=y.empty,w=y.create,O=r.CompositeDisposable,k=r.SingleAssignmentDisposable,j=r.Scheduler,A=r.internals.ScheduledItem,_=r.internals.SchedulePeriodicRecursive,E=r.internals.PriorityQueue,x=r.internals.inherits,S=r.helpers.notImplemented,T=r.helpers.defaultComparer=function(e,t){return fe(e,t)},R=r.Notification=function(){function e(){}return e.prototype._accept=function(e,t,r){throw new NotImplementedError},e.prototype._acceptObserver=function(e,t,r){throw new NotImplementedError},e.prototype.accept=function(e,t,r){return e&&"object"==typeof e?this._acceptObserver(e):this._accept(e,t,r)},e.prototype.toObservable=function(e){var t=this;return isScheduler(e)||(e=immediateScheduler),new AnonymousObservable(function(r){return e.schedule(t,function(e,t){t._acceptObserver(r),"N"===t.kind&&r.onCompleted()})})},e}(),N=function(e){function t(e){this.value=e,this.kind="N"}return x(t,e),t.prototype._accept=function(e){return e(this.value)},t.prototype._acceptObserver=function(e){return e.onNext(this.value)},t.prototype.toString=function(){return"OnNext("+this.value+")"},t}(R),C=function(e){function t(e){this.error=e,this.kind="E"}return x(t,e),t.prototype._accept=function(e,t){return t(this.error)},t.prototype._acceptObserver=function(e){return e.onError(this.error)},t.prototype.toString=function(){return"OnError("+this.error+")"},t}(R),q=function(e){function t(){this.kind="C"}return x(t,e),t.prototype._accept=function(e,t,r){return r()},t.prototype._acceptObserver=function(e){return e.onCompleted()},t.prototype.toString=function(){return"OnCompleted()"},t}(R),P=(R.createOnNext=function(e){return new N(e)},R.createOnError=function(e){return new C(e)},R.createOnCompleted=function(){return new q},["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]),I=(P.length,"[object Arguments]"),D="[object Array]",F="[object Boolean]",M="[object Date]",U="[object Error]",L="[object Function]",B="[object Map]",V="[object Number]",X="[object Object]",H="[object RegExp]",Q="[object Set]",W="[object String]",z="[object WeakMap]",G="[object ArrayBuffer]",J="[object Float32Array]",K="[object Float64Array]",Y="[object Int8Array]",Z="[object Int16Array]",$="[object Int32Array]",ee="[object Uint8Array]",te="[object Uint8ClampedArray]",re="[object Uint16Array]",ne="[object Uint32Array]",se={};se[J]=se[K]=se[Y]=se[Z]=se[$]=se[ee]=se[te]=se[re]=se[ne]=!0,se[I]=se[D]=se[G]=se[F]=se[M]=se[U]=se[L]=se[B]=se[V]=se[X]=se[H]=se[Q]=se[W]=se[z]=!1;var oe=Object.prototype,ie=oe.hasOwnProperty,ce=oe.toString,ue=Math.pow(2,53)-1,le=Object.keys||function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(s){if("object"!=typeof s&&("function"!=typeof s||null===s))throw new TypeError("Object.keys called on non-object");var o,i,c=[];for(o in s)e.call(s,o)&&c.push(o);if(t)for(i=0;n>i;i++)e.call(s,r[i])&&c.push(r[i]);return c}}(),ae=r.internals.isObject=function(e){var t=typeof e;return!!e&&("object"===t||"function"===t)},he=function(){try{Object({toString:0}+"")}catch(e){return function(){return!1}}return function(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}}(),pe=Array.isArray||function(e){return i(e)&&c(e.length)&&ce.call(e)===D},fe=r.internals.isEqual=function(e,t){return p(e,t)},_=r.internals.SchedulePeriodicRecursive=function(){function e(e){return function(t,r){r(0,e._period);var n=tryCatch(e._action)(e._state);n===errorObj&&(e._cancel.dispose(),thrower(n.e)),e._state=n}}function t(e,t,r,n){this._scheduler=e,this._state=t,this._period=r,this._action=n}return t.prototype.start=function(){var t=new k;return this._cancel=t,t.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,e(this))),t},t}(),de=r.VirtualTimeScheduler=function(e){function t(t,r){this.clock=t,this.comparer=r,this.isEnabled=!1,this.queue=new E(1024),e.call(this)}x(t,e);var r=t.prototype;return r.now=function(){return this.toAbsoluteTime(this.clock)},r.schedule=function(e,t){return this.scheduleAbsolute(e,this.clock,t)},r.scheduleFuture=function(e,t,r){var n=t instanceof Date?this.toRelativeTime(t-this.now()):this.toRelativeTime(t);return this.scheduleRelative(e,n,r)},r.add=S,r.toAbsoluteTime=S,r.toRelativeTime=S,r.schedulePeriodic=function(e,t,r){var n=new _(this,e,t,r);return n.start()},r.scheduleRelative=function(e,t,r){var n=this.add(this.clock,t);return this.scheduleAbsolute(e,n,r)},r.start=function(){if(!this.isEnabled){this.isEnabled=!0;do{var e=this.getNext();null!==e?(this.comparer(e.dueTime,this.clock)>0&&(this.clock=e.dueTime),e.invoke()):this.isEnabled=!1}while(this.isEnabled)}},r.stop=function(){this.isEnabled=!1},r.advanceTo=function(e){var t=this.comparer(this.clock,e);if(this.comparer(this.clock,e)>0)throw new ArgumentOutOfRangeError;if(0!==t&&!this.isEnabled){this.isEnabled=!0;do{var r=this.getNext();null!==r&&this.comparer(r.dueTime,e)<=0?(this.comparer(r.dueTime,this.clock)>0&&(this.clock=r.dueTime),r.invoke()):this.isEnabled=!1}while(this.isEnabled);this.clock=e}},r.advanceBy=function(e){var t=this.add(this.clock,e),r=this.comparer(this.clock,t);if(r>0)throw new ArgumentOutOfRangeError;0!==r&&this.advanceTo(t)},r.sleep=function(e){var t=this.add(this.clock,e);if(this.comparer(this.clock,t)>=0)throw new ArgumentOutOfRangeError;this.clock=t},r.getNext=function(){for(;this.queue.length>0;){var e=this.queue.peek();if(!e.isCancelled())return e;this.queue.dequeue()}return null},r.scheduleAbsolute=function(e,t,r){function n(e,t){return s.queue.remove(o),r(e,t)}var s=this,o=new A(this,e,n,t,this.comparer);return this.queue.enqueue(o),o.disposable},t}(j);f.prototype.equals=function(e){return e===this?!0:null==e?!1:"N"!==e.kind?!1:this.predicate(e.value)},d.prototype.equals=function(e){return e===this?!0:null==e?!1:"E"!==e.kind?!1:this.predicate(e.error)};var be=r.ReactiveTest={created:100,subscribed:200,disposed:1e3,onNext:function(e,t){return"function"==typeof t?new ve(e,new f(t)):new ve(e,R.createOnNext(t))},onError:function(e,t){return"function"==typeof t?new ve(e,new d(t)):new ve(e,R.createOnError(t))},onCompleted:function(e){return new ve(e,R.createOnCompleted())},subscribe:function(e,t){return new me(e,t)}},ve=r.Recorded=function(e,t,r){this.time=e,this.value=t,this.comparer=r||T};ve.prototype.equals=function(e){return this.time===e.time&&this.comparer(this.value,e.value)},ve.prototype.toString=function(){return this.value.toString()+"@"+this.time};var me=r.Subscription=function(e,t){this.subscribe=e,this.unsubscribe=t||Number.MAX_VALUE};me.prototype.equals=function(e){return this.subscribe===e.subscribe&&this.unsubscribe===e.unsubscribe},me.prototype.toString=function(){return"("+this.subscribe+", "+(this.unsubscribe===Number.MAX_VALUE?"Infinite":this.unsubscribe)+")"};var ye=r.MockDisposable=function(e){this.scheduler=e,this.disposes=[],this.disposes.push(this.scheduler.clock)};ye.prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};var ge=function(e){function t(t){e.call(this),this.scheduler=t,this.messages=[]}x(t,e);var r=t.prototype;return r.onNext=function(e){this.messages.push(new ve(this.scheduler.clock,R.createOnNext(e)))},r.onError=function(e){this.messages.push(new ve(this.scheduler.clock,R.createOnError(e)))},r.onCompleted=function(){this.messages.push(new ve(this.scheduler.clock,R.createOnCompleted()))},t}(v);b.prototype.then=function(e,t){var s=this;this.subscriptions.push(new me(this.scheduler.clock));var o,i=this.subscriptions.length-1,c=r.Observer.create(function(t){var u=e(t);if(u&&"function"==typeof u.then)o=u;else{var l=s.scheduler.clock;o=new b(s.scheduler,[r.ReactiveTest.onNext(l,n),r.ReactiveTest.onCompleted(l)])}var a=s.observers.indexOf(c);s.observers.splice(a,1),s.subscriptions[i]=new me(s.subscriptions[i].subscribe,s.scheduler.clock)},function(e){t(e);var r=s.observers.indexOf(c);s.observers.splice(r,1),s.subscriptions[i]=new me(s.subscriptions[i].subscribe,s.scheduler.clock)});return this.observers.push(c),o||new b(this.scheduler,this.messages)};var we=function(e){function t(t,r){e.call(this);var n,s,o=this;this.scheduler=t,this.messages=r,this.subscriptions=[],this.observers=[];for(var i=0,c=this.messages.length;c>i;i++)n=this.messages[i],s=n.value,function(e){t.scheduleAbsolute(null,n.time,function(){for(var t=o.observers.slice(0),r=0,n=t.length;n>r;r++)e.accept(t[r]);return g})}(s)}return x(t,e),t.prototype._subscribe=function(e){var t=this;this.observers.push(e),this.subscriptions.push(new me(this.scheduler.clock));var r=this.subscriptions.length-1;return w(function(){var n=t.observers.indexOf(e);t.observers.splice(n,1),t.subscriptions[r]=new me(t.subscriptions[r].subscribe,t.scheduler.clock)})},t}(m),Oe=function(e){function t(t,r){e.call(this),this.scheduler=t,this.messages=r,this.subscriptions=[]}return x(t,e),t.prototype._subscribe=function(e){var t,r,n=this;this.subscriptions.push(new me(this.scheduler.clock));for(var s=this.subscriptions.length-1,o=new O,i=0,c=this.messages.length;c>i;i++)t=this.messages[i],r=t.value,function(r){o.add(n.scheduler.scheduleRelative(null,t.time,function(){return r.accept(e),g}))}(r);return w(function(){n.subscriptions[s]=new me(n.subscriptions[s].subscribe,n.scheduler.clock),o.dispose()})},t}(m);return r.TestScheduler=function(e){function t(e,t){return e>t?1:t>e?-1:0}function n(){e.call(this,0,t)}return x(n,e),n.prototype.scheduleAbsolute=function(t,r,n){return r<=this.clock&&(r=this.clock+1),e.prototype.scheduleAbsolute.call(this,t,r,n)},n.prototype.add=function(e,t){return e+t},n.prototype.toAbsoluteTime=function(e){return new Date(e).getTime()},n.prototype.toRelativeTime=function(e){return e},n.prototype.startScheduler=function(e,t){t||(t={}),null==t.created&&(t.created=be.created),null==t.subscribed&&(t.subscribed=be.subscribed),null==t.disposed&&(t.disposed=be.disposed);var r,n,s=this.createObserver();return this.scheduleAbsolute(null,t.created,function(){return r=e(),g}),this.scheduleAbsolute(null,t.subscribed,function(){return n=r.subscribe(s),g}),this.scheduleAbsolute(null,t.disposed,function(){return n.dispose(),g}),this.start(),s},n.prototype.createHotObservable=function(){var e,t=arguments.length;if(Array.isArray(arguments[0]))e=arguments[0];else{e=new Array(t);for(var r=0;t>r;r++)e[r]=arguments[r]}return new we(this,e)},n.prototype.createColdObservable=function(){var e,t=arguments.length;if(Array.isArray(arguments[0]))e=arguments[0];else{e=new Array(t);for(var r=0;t>r;r++)e[r]=arguments[r]}return new Oe(this,e)},n.prototype.createResolvedPromise=function(e,t){return new b(this,[r.ReactiveTest.onNext(e,t),r.ReactiveTest.onCompleted(e)])},n.prototype.createRejectedPromise=function(e,t){return new b(this,[r.ReactiveTest.onError(e,t)])},n.prototype.createObserver=function(){return new ge(this)},n}(de),r});