(function(e){function t(e){return e&&e.Object===Object?e:null}var i={"function":!0,object:!0},n=i[typeof exports]&&exports&&!exports.nodeType?exports:null,o=i[typeof module]&&module&&!module.nodeType?module:null,r=t(n&&o&&"object"==typeof global&&global),u=t(i[typeof self]&&self),s=t(i[typeof window]&&window),l=(o&&o.exports===n?n:null,t(i[typeof this]&&this)),c=r||s!==(l&&l.window)&&s||u||l||Function("return this")();"function"==typeof define&&define.amd?define(["./rx.lite"],function(t,i){return e(c,i,t)}):"object"==typeof module&&module&&module.exports===n?module.exports=e(c,module.exports,require("rx-lite")):c.Rx=e(c,{},c.Rx)}).call(this,function(e,t,i,n){var o=i.Scheduler,r=i.internals.ScheduledItem,u=i.internals.SchedulePeriodicRecursive,s=i.internals.PriorityQueue,l=i.internals.inherits,c=i.helpers.defaultSubComparer,h=i.helpers.notImplemented;i.VirtualTimeScheduler=function(e){function t(t,i){this.clock=t,this.comparer=i,this.isEnabled=!1,this.queue=new s(1024),e.call(this)}l(t,e);var i=t.prototype;return i.now=function(){return this.toAbsoluteTime(this.clock)},i.schedule=function(e,t){return this.scheduleAbsolute(e,this.clock,t)},i.scheduleFuture=function(e,t,i){var n=t instanceof Date?this.toRelativeTime(t-this.now()):this.toRelativeTime(t);return this.scheduleRelative(e,n,i)},i.add=h,i.toAbsoluteTime=h,i.toRelativeTime=h,i.schedulePeriodic=function(e,t,i){var n=new u(this,e,t,i);return n.start()},i.scheduleRelative=function(e,t,i){var n=this.add(this.clock,t);return this.scheduleAbsolute(e,n,i)},i.start=function(){if(!this.isEnabled){this.isEnabled=!0;do{var e=this.getNext();null!==e?(this.comparer(e.dueTime,this.clock)>0&&(this.clock=e.dueTime),e.invoke()):this.isEnabled=!1}while(this.isEnabled)}},i.stop=function(){this.isEnabled=!1},i.advanceTo=function(e){var t=this.comparer(this.clock,e);if(this.comparer(this.clock,e)>0)throw new ArgumentOutOfRangeError;if(0!==t&&!this.isEnabled){this.isEnabled=!0;do{var i=this.getNext();null!==i&&this.comparer(i.dueTime,e)<=0?(this.comparer(i.dueTime,this.clock)>0&&(this.clock=i.dueTime),i.invoke()):this.isEnabled=!1}while(this.isEnabled);this.clock=e}},i.advanceBy=function(e){var t=this.add(this.clock,e),i=this.comparer(this.clock,t);if(i>0)throw new ArgumentOutOfRangeError;0!==i&&this.advanceTo(t)},i.sleep=function(e){var t=this.add(this.clock,e);if(this.comparer(this.clock,t)>=0)throw new ArgumentOutOfRangeError;this.clock=t},i.getNext=function(){for(;this.queue.length>0;){var e=this.queue.peek();if(!e.isCancelled())return e;this.queue.dequeue()}return null},i.scheduleAbsolute=function(e,t,i){function n(e,t){return o.queue.remove(u),i(e,t)}var o=this,u=new r(this,e,n,t,this.comparer);return this.queue.enqueue(u),u.disposable},t}(o);return i.HistoricalScheduler=function(e){function t(t,i){var n=null==t?0:t,o=i||c;e.call(this,n,o)}l(t,e);var i=t.prototype;return i.add=function(e,t){return e+t},i.toAbsoluteTime=function(e){return new Date(e).getTime()},i.toRelativeTime=function(e){return e},t}(i.VirtualTimeScheduler),i});