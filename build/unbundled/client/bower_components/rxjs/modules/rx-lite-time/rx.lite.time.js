(function(t){function e(t){return t&&t.Object===Object?t:null}var n={"function":!0,object:!0},r=n[typeof exports]&&exports&&!exports.nodeType?exports:null,i=n[typeof module]&&module&&!module.nodeType?module:null,o=e(r&&i&&"object"==typeof global&&global),s=e(n[typeof self]&&self),u=e(n[typeof window]&&window),h=(i&&i.exports===r?r:null,e(n[typeof this]&&this)),l=o||u!==(h&&h.window)&&u||s||h||Function("return this")();"function"==typeof define&&define.amd?define(["./rx.lite"],function(e,n){return t(l,n,e)}):"object"==typeof module&&module&&module.exports===r?module.exports=t(l,module.exports,require("rx-lite")):l.Rx=t(l,{},l.Rx)}).call(this,function(t,e,n,r){function i(t){return function(){try{return t.apply(this,arguments)}catch(e){return F.e=e,F}}}function o(t){return t.toArray()}function o(t){return t.toArray()}var s=n.internals.inherits,u=n.internals.AbstractObserver,h=n.Observable,l=h.prototype,c=n.AnonymousObservable,f=n.ObservableBase,a=(h.defer,h.empty,h.never,h["throw"],h.fromArray,n.Scheduler["default"]),p=n.SingleAssignmentDisposable,_=n.SerialDisposable,d=n.CompositeDisposable,w=n.BinaryDisposable,b=n.RefCountDisposable,v=n.Subject,m=n.internals.addRef,y=(n.Scheduler.normalize,n.helpers),C=(y.isPromise,y.isFunction),x=n.Scheduler.isScheduler,F=(h.fromPromise,{e:{}}),S=n.internals.tryCatch=function(t){if(!C(t))throw new TypeError("fn must be a function");return i(t)};l.windowWithTime=l.windowTime=function(t,e,n){var r,i=this;return null==e&&(r=t),x(n)||(n=a),"number"==typeof e?r=e:x(e)&&(r=t,n=e),new c(function(e){function o(){var t=new p,i=!1,s=!1;f.setDisposable(t),l===h?(i=!0,s=!0):h>l?i=!0:s=!0;var _=i?l:h,d=_-a;a=_,i&&(l+=r),s&&(h+=r),t.setDisposable(n.scheduleFuture(null,d,function(){if(s){var t=new v;c.push(t),e.onNext(m(t,u))}i&&c.shift().onCompleted(),o()}))}var s,u,h=r,l=t,c=[],f=new _,a=0;return s=new d(f),u=new b(s),c.push(new v),e.onNext(m(c[0],u)),o(),s.add(i.subscribe(function(t){for(var e=0,n=c.length;n>e;e++)c[e].onNext(t)},function(t){for(var n=0,r=c.length;r>n;n++)c[n].onError(t);e.onError(t)},function(){for(var t=0,n=c.length;n>t;t++)c[t].onCompleted();e.onCompleted()})),u},i)},l.windowWithTimeOrCount=l.windowTimeOrCount=function(t,e,n){var r=this;return x(n)||(n=a),new c(function(i){function o(e){var r=new p;s.setDisposable(r),r.setDisposable(n.scheduleFuture(null,t,function(){if(e===c){l=0;var t=++c;f.onCompleted(),f=new v,i.onNext(m(f,h)),o(t)}}))}var s=new _,u=new d(s),h=new b(u),l=0,c=0,f=new v;return i.onNext(m(f,h)),o(0),u.add(r.subscribe(function(t){var n=0,r=!1;f.onNext(t),++l===e&&(r=!0,l=0,n=++c,f.onCompleted(),f=new v,i.onNext(m(f,h))),r&&o(n)},function(t){f.onError(t),i.onError(t)},function(){f.onCompleted(),i.onCompleted()})),h},r)},l.bufferWithTime=l.bufferTime=function(t,e,n){return this.windowWithTime(t,e,n).flatMap(o)},l.bufferWithTimeOrCount=l.bufferTimeOrCount=function(t,e,n){return this.windowWithTimeOrCount(t,e,n).flatMap(o)};var T=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return s(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new E(t,this._s))},e}(f),E=function(t){function e(e,n){this._o=e,this._s=n,this._l=n.now(),t.call(this)}return s(e,t),e.prototype.next=function(t){var e=this._s.now(),n=e-this._l;this._l=e,this._o.onNext({value:t,interval:n})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(u);l.timeInterval=function(t){return x(t)||(t=a),new T(this,t)};var R=function(t){function e(e,n,r,i,o,s){this._state=e,this._cndFn=n,this._itrFn=r,this._resFn=i,this._timeFn=o,this._s=s,t.call(this)}function n(t,e){if(t.hasResult&&t.o.onNext(t.result),t.first)t.first=!1;else if(t.newState=S(t.self._itrFn)(t.newState),t.newState===F)return t.o.onError(t.newState.e);if(t.hasResult=S(t.self._cndFn)(t.newState),t.hasResult===F)return t.o.onError(t.hasResult.e);if(t.hasResult){if(t.result=S(t.self._resFn)(t.newState),t.result===F)return t.o.onError(t.result.e);var n=S(t.self._timeFn)(t.newState);if(n===F)return t.o.onError(n.e);e(t,n)}else t.o.onCompleted()}return s(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(e,new Date(this._s.now()),n)},e}(f);h.generateWithAbsoluteTime=function(t,e,n,r,i,o){return x(o)||(o=a),new R(t,e,n,r,i,o)};var q=function(t){function e(e,n,r,i,o,s){this._state=e,this._cndFn=n,this._itrFn=r,this._resFn=i,this._timeFn=o,this._s=s,t.call(this)}function n(t,e){if(t.hasResult&&t.o.onNext(t.result),t.first)t.first=!1;else if(t.newState=S(t.self._itrFn)(t.newState),t.newState===F)return t.o.onError(t.newState.e);if(t.hasResult=S(t.self._cndFn)(t.newState),t.hasResult===F)return t.o.onError(t.hasResult.e);if(t.hasResult){if(t.result=S(t.self._resFn)(t.newState),t.result===F)return t.o.onError(t.result.e);var n=S(t.self._timeFn)(t.newState);if(n===F)return t.o.onError(n.e);e(t,n)}else t.o.onCompleted()}return s(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(e,0,n)},e}(f);h.generateWithRelativeTime=function(t,e,n,r,i,o){return x(o)||(o=a),new q(t,e,n,r,i,o)};var N=function(t){function e(e,n,r){this.source=e,this._dt=n,this._s=r,t.call(this)}function n(t,e){var n=e[0],r=e[1],i=e[2];i.setDisposable(n.subscribe(r))}return s(e,t),e.prototype.subscribeCore=function(t){var e=new _;return e.setDisposable(this._s.scheduleFuture([this.source,t,e],this._dt,n)),e},e}(f);l.delaySubscription=function(t,e){return x(e)||(e=a),new N(this,t,e)};var g=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,t.call(this)}return s(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new W(t,this))},e}(f),W=function(t){function e(e,n){this._o=e,this._s=n._s,this._d=n._d,this._q=[],t.call(this)}return s(e,t),e.prototype.next=function(t){var e=this._s.now();for(this._q.push({interval:e,value:t});this._q.length>0&&e-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(var t=this._s.now();this._q.length>0&&t-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value);this._o.onCompleted()},e}(u);l.skipLastWithTime=function(t,e){return x(e)||(e=a),new g(this,t,e)};var D=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,t.call(this)}return s(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new O(t,this._d,this._s))},e}(f),O=function(t){function e(e,n,r){this._o=e,this._d=n,this._s=r,this._q=[],t.call(this)}return s(e,t),e.prototype.next=function(t){var e=this._s.now();for(this._q.push({interval:e,value:t});this._q.length>0&&e-this._q[0].interval>=this._d;)this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(var t=this._s.now();this._q.length>0;){var e=this._q.shift();t-e.interval<=this._d&&this._o.onNext(e.value)}this._o.onCompleted()},e}(u);l.takeLastWithTime=function(t,e){return x(e)||(e=a),new D(this,t,e)},l.takeLastBufferWithTime=function(t,e){var n=this;return x(e)||(e=a),new c(function(r){var i=[];return n.subscribe(function(n){var r=e.now();for(i.push({interval:r,value:n});i.length>0&&r-i[0].interval>=t;)i.shift()},function(t){r.onError(t)},function(){for(var n=e.now(),o=[];i.length>0;){var s=i.shift();n-s.interval<=t&&o.push(s.value)}r.onNext(o),r.onCompleted()})},n)};var k=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,t.call(this)}function n(t,e){e.onCompleted()}return s(e,t),e.prototype.subscribeCore=function(t){return new w(this._s.scheduleFuture(t,this._d,n),this.source.subscribe(t))},e}(f);l.takeWithTime=function(t,e){return x(e)||(e=a),new k(this,t,e)};var A=function(t){function e(e,n,r){this.source=e,this._d=n,this._s=r,this._open=!1,t.call(this)}function n(t,e){e._open=!0}return s(e,t),e.prototype.subscribeCore=function(t){return new w(this._s.scheduleFuture(this,this._d,n),this.source.subscribe(new j(t,this)))},e}(f),j=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return s(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(u);l.skipWithTime=function(t,e){return x(e)||(e=a),new A(this,t,e)};var B=function(t){function e(e,n,r){this.source=e,this._st=n,this._s=r,t.call(this)}function n(t,e){e._open=!0}return s(e,t),e.prototype.subscribeCore=function(t){return this._open=!1,new w(this._s.scheduleFuture(this,this._st,n),this.source.subscribe(new L(t,this)))},e}(f),L=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return s(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(u);return l.skipUntilWithTime=function(t,e){return x(e)||(e=a),new B(this,t,e)},l.takeUntilWithTime=function(t,e){x(e)||(e=a);var n=this;return new c(function(r){return new w(e.scheduleFuture(r,t,function(t,e){e.onCompleted()}),n.subscribe(r))},n)},n});